# 概述：编写一个基于CGAN的降噪模型，用于去除心跳信号中的噪声。
# 数据集概况：
## 数据集包含心跳信号的数据，数据格式为若干`.mat`文件。每个.mat文件都有`accresult`属性，形状为4\*5000。只使用每个`.mat`的第二个1\*5000的数据(即从0开始索引的第1条)，为10s内xyz的加速度数据。
- 静息时候的数据存储在`test_data\device3\p4-test\sjx`路径下。路径文件夹内有大于100条的`.mat`文件。采集自静止状态下的心跳信号，几乎不包含噪声。
- 噪音分为3种，分别存储在`collect_data\device3\noise_phone\sjx\scg`, `collect_data\device3\noise_head\sjx\scg`, `collect_data\device3\noise_chew\sjx\scg`路径下。每个路径文件夹内有大于30条的`.mat`文件。采集自噪音状态下的心跳信号，包含不同类型的噪声。
- 所属噪声类别：`phone`、`head`、`chew`。作为CGAN的条件输入。
# 项目结构：
- 项目基于pytorch实现，运行在windows10系统上。
- 对数据进行滑动窗口处理，每个窗口的长度为2000，步长为200。
   
## dataloader.py:
- 负责实现数据加载部分的内容。

## model.py:
- 负责实现降噪模型的结构。生成器采用UNet结构，对输入的噪音信号进行降噪处理。
- 判别器采用CNN结构，对降噪后的信号进行判别，判断是否为真实信号。

## train.py:
- 使用全部静息数据和按顺序前25条噪音数据进行训练，每个batch的大小为32。
- 超参数放在代码前面部分，使用进度条tqdm进行训练过程的可视化，每5epoch保存一次模型，保存在相对路径'gan_models/'下(文件夹可能需要创建)。
- 使用Adam优化器，学习率为0.002，训练50epoch。

## test.py:
- 加载保存的模型，对没加载到训练集的5条噪音数据进行降噪处理，计算降噪后的信号通过判别器的概率。
- 保存各种指标，写入一行到`gan_results.txt`文件中。